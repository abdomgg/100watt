<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data noupdate="0">
        <!-- Override product multi-company rule to use 'in' instead of 'parent_of' -->
        <record id="product.product_comp_rule" model="ir.rule">
            <field name="name">Product multi-company</field>
            <field name="model_id" ref="product.model_product_template"/>
            <field name="domain_force">['|', ('company_id', 'in', company_ids), ('company_id', '=', False)]</field>
        </record>

        <!-- Override partner multi-company rule to use 'in' instead of 'parent_of' -->
        <record id="base.res_partner_rule" model="ir.rule">
            <field name="name">res.partner company</field>
            <field name="model_id" ref="base.model_res_partner"/>
            <field name="domain_force">['|', '|', '|', ('id', '=', False), ('partner_share', '=', False), ('company_id', 'in', company_ids), ('company_id', '=', False)]</field>
        </record>


        <!-- Admin bypass rule for products - full access to all companies -->
        <record id="product_admin_rule" model="ir.rule">
            <field name="name">Product: Admin Full Access</field>
            <field name="model_id" ref="product.model_product_template"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_system'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>

        <!-- Admin bypass rule for product variants - full access -->
        <record id="product_product_admin_rule" model="ir.rule">
            <field name="name">Product Variant: Admin Full Access</field>
            <field name="model_id" ref="product.model_product_product"/>
            <field name="domain_force">[(1, '=', 1)]</field>
            <field name="groups" eval="[(4, ref('base.group_system'))]"/>
            <field name="perm_read" eval="True"/>
            <field name="perm_write" eval="True"/>
            <field name="perm_create" eval="True"/>
            <field name="perm_unlink" eval="True"/>
        </record>
    </data>
</odoo>
